import paramiko
import datetime
import time
import os



ip_address = {"10.197.0.1":"Intelliteach AR",
"10.197.0.2":"Rajan AR",
"10.197.0.3":"Sandeep_LCO AR",
"10.197.0.4":"Fairfield AR",
"10.197.0.5":"Lazy Lagoon AR",
"10.197.0.6":"Sun Pride Village AR",
"10.197.0.7":"foldax AR",
"10.197.0.8":"browntape AR",
"10.197.0.9":"Chowgule AR",
"10.197.0.10":"Pacific Hotel AR",
"10.197.0.11":"Whotel AR",
"10.197.0.12":"Centaur Pharm AR",
"10.197.0.13":"Hilton Arpora AR",
"10.197.0.14":"GreenMeadows AR",
"10.197.0.15":"Jubiliant AR",
"10.197.0.16":"Ashol LCO AR",
"10.197.0.17":"dmc AR",
"10.197.0.18":"Bloom suites AR",
"10.197.0.19":"Maravilha AR",
"10.197.0.20":"Le Meridien AR",
"10.197.0.21":"Avtara AR",
"10.197.0.22":"Whispering Palms AR",
"10.197.0.23":"Chalston AR",
"10.197.0.24":"Bloomroom AR",
"10.197.0.25":"Radisson AR",
"10.197.0.26":"Aries Marine AR",
"10.197.0.27":"RADISSON BLU RESORT GOA, CAVELOSSIM AR",
"10.197.0.28":"praya villa morjim AR",
"10.197.0.29":"Acacia AR",
"10.197.0.30":"cocomia AR",
"10.197.0.31":"countryinn candolim AR",
"10.197.0.32":"sangam cultivatorss AR",
"10.197.0.33":"Select Holiday Resort AR",
"10.197.0.34":"Sendor Meson AR",
"10.197.0.35":"Optel AR",
"10.197.0.36":"Cipla AR",
"10.197.0.37":"Sierra Circuits AR",
"10.197.0.38":"molbio diagnostics AR",
"10.197.0.39":"Nalux AR",
"10.197.0.40":"ion exchange AR",
"10.197.0.41":"Masibus AR",
"10.197.0.42":"ziva AR",
"10.197.0.43":"Mapusa MLA AR",
"10.197.0.44":"Goldfinch AR",
"10.197.0.45":"Atlas fisheries AR",
"10.197.0.46":"Mercedes AR",
"10.197.0.47":"Dempo sports AR",
"10.197.0.48":"Healthway oldgoa AR",
"10.197.0.49":"donbosco fire margao AR",
"10.197.0.50":"pARVATI CHOWGULE AR",
"10.197.0.51":"ginger hotel AR",
"10.197.0.52":"sunshine AR",
"10.197.0.53":"esselpropack AR",
"10.197.0.54":"delfino taleigao AR",
"10.197.0.55":"gemini AR",
"10.197.0.56":"Tulip  Diagnostics AR",
"10.197.0.57":"Baywatch AR",
"10.197.0.58":"Karma royal palms AR",
"10.197.0.59":"HaatiMahal AR",
"10.197.0.60":"Royal Orchid AR",
"10.197.0.61":"beleza AR",
"10.197.0.62":"taj exotica AR",
"10.197.0.63":"club mahindra varca AR",
"10.197.0.64":"Arcis AR",
"10.197.0.65":"Panjim Petrol Pump AR",
"10.197.0.66":"CFL Pharma AR",
"10.197.0.67":"Country_INN_Panjim AR",
"10.197.0.68":"Tangentia_Patto AR",
"10.197.0.69":"Consulado_Portugal AR",
"10.197.0.70":"Helmerich AR",
"10.197.0.71":"Marmalade AR",
"10.197.0.72":"International center AR",
"10.197.0.73":"cmr surical AR",
"10.197.0.74":"crown hotel AR",
"10.197.0.75":"Taj vivanta miramar AR",
"10.197.0.76":"healthway panjim AR",
"10.197.0.77":"noah ark AR",
"10.197.0.78":"Detin jetty AR",
"10.197.0.79":"TRIPEZRA PVT. LTD AR",
"10.196.0.81":"AR",
"10.196.0.82":"AR",
"10.196.0.83":"AR",
"10.196.0.84":"AR",
"10.196.0.85":"AR",
"10.196.0.86":"AR",
"10.196.0.88":"AR",
"10.196.0.89":"AR",
"10.196.0.91":"AR",
"10.196.0.92":"AR",
"10.196.0.93":"AR",
"10.196.0.94":"AR",
"10.196.0.95":"AR",
"10.196.0.96":"AR",
"10.196.0.97":"AR",
"10.196.0.98":"AR",
"10.196.0.99":"AR",
"10.196.0.100":"AR",
"10.196.0.101":"AR",
"10.196.0.102":"AR",
"10.196.0.103":"AR",
"10.196.0.104":"AR",
"10.196.0.105":"AR",
"10.196.0.106":"AR",
"10.196.0.107":"AR",
"10.196.0.108":"AR",
"10.196.0.109":"AR",
"10.196.0.110":"AR",
"10.196.0.111":"AR",
"10.196.0.112":"AR",
"10.196.0.113":"AR",
"10.196.0.114":"AR",
"10.196.0.115":"AR",
"10.196.0.116":"AR",
"10.196.0.117":"AR",
"10.196.0.118":"AR",
"10.196.0.119":"AR",
"10.196.0.120":"AR",
"10.196.0.121":"AR",
"10.196.0.122":"AR",
"10.196.0.123":"AR",
"10.196.0.124":"AR",
"10.196.0.125":"AR",
"10.196.0.126":"AR",
"10.196.0.128":"AR",
"10.196.0.129":"AR",
"10.196.0.130":"AR",
"10.196.0.131":"AR",
"10.196.0.132":"AR",
"10.196.0.133":"AR",
"10.196.0.134":"AR",
"10.196.0.135":"AR",
"10.196.0.136":"AR",
"10.196.0.137":"AR",
"10.196.0.138":"AR",
"10.196.0.139":"AR",
"10.196.0.140":"AR",
"10.196.0.141":"AR",
"10.196.0.142":"AR",
"10.196.0.143":"AR",
"10.196.0.144":"AR",
"10.196.0.145":"AR",
"10.196.0.146":"AR",
"10.196.0.147":"AR",
"10.196.0.148":"AR",
"10.196.0.149":"AR",
"10.196.0.150":"AR",
"10.196.0.151":"AR",
"10.196.0.152":"AR",
"10.196.0.153":"AR",
"10.196.0.154":"AR",
"10.196.0.155":"AR",
"10.196.0.156":"AR",
"10.196.0.157":"AR",
"10.196.0.158":"AR",
"10.196.0.159":"AR",
"10.196.0.160":"AR",
"10.196.0.161":"AR",
"10.196.0.162":"AR",
"10.196.0.163":"AR",
"10.196.0.164":"AR",
"10.196.0.165":"AR",
"10.196.0.166":"AR",
"10.196.0.167":"AR",
"10.196.0.168":"AR",
"10.196.0.169":"AR",
"10.196.0.170":"AR",
"10.196.0.171":"AR",
"10.196.0.172":"AR",
"10.196.0.173":"AR",
"10.196.0.174":"AR",
"10.196.0.175":"AR",
"10.196.0.176":"AR",
"10.196.0.177":"AR",
"10.196.0.178":"AR",
"10.196.0.179":"AR",
"10.196.0.180":"AR",
"10.196.0.181":"AR",
"10.196.0.182":"AR",
"10.196.0.183":"AR",
"10.196.0.184":"AR",
"10.196.0.185":"AR",
"10.196.0.186":"AR",
"10.196.0.188":"AR",
"10.196.0.189":"AR",
"10.196.0.191":"AR",
"10.196.0.192":"AR",
"10.196.0.193":"AR",
"10.196.0.194":"AR",
"10.196.0.195":"AR",
"10.196.0.196":"AR",
"10.196.0.197":"AR",
"10.196.0.198":"AR",
"10.196.0.199":"AR",
"10.196.0.200":"AR",
"10.196.0.201":"AR",
"10.196.0.202":"AR",
"10.196.0.203":"AR",
"10.196.0.204":"AR",
"10.196.0.205":"AR",
"10.196.0.206":"AR",
"10.196.0.207":"AR",
"10.196.0.208":"AR",
"10.196.0.209":"AR",
"10.196.0.210":"AR",
"10.196.0.211":"AR",
"10.196.0.212":"AR",
"10.196.0.213":"AR",
"10.196.0.214":"AR",
"10.196.0.215":"AR",
"10.196.0.216":"AR",
"10.196.0.217":"AR",
"10.196.0.218":"AR",
"10.196.0.219":"AR",
"10.196.0.220":"AR",
"10.196.0.221":"AR",
"10.196.0.222":"AR",
"10.196.0.223":"AR",
"10.196.0.224":"AR",
"10.196.0.225":"AR",
"10.196.0.226":"AR",
"10.196.0.228":"AR",
"10.196.0.229":"AR",
"10.196.0.230":"AR",
"10.196.0.231":"AR",
"10.196.0.232":"AR",
"10.196.0.233":"AR",
"10.196.0.234":"AR",
"10.196.0.235":"AR",
"10.196.0.236":"AR",
"10.196.0.237":"AR",
"10.196.0.238":"AR",
"10.196.0.239":"AR",
"10.196.0.240":"AR",
"10.196.0.241":"AR",
"10.196.0.242":"AR",
"10.196.0.243":"AR",
"10.196.0.244":"AR",
"10.196.0.245":"AR",
"10.196.0.246":"AR",
"10.196.0.247":"AR",
"10.196.0.248":"AR",
"10.196.0.249":"AR",
"10.196.0.250":"AR",
"10.196.0.251":"AR",
"10.196.0.252":"AR",
"10.196.0.253":"AR",


 }



for ip in ip_address:
    try:
        conn = paramiko.SSHClient()  # High-level representation of a session with an SSH server
        conn.set_missing_host_key_policy(paramiko.AutoAddPolicy())  # When 1st connection, ask to trust this server or not
        conn.connect(ip, 22, "hemant@expl", "heyfucker")  # Initiate SSH connection with IP, Port, Username, Password
        commands = conn.invoke_shell()  # Request an interactive shell session on this channel.
        time.sleep(1)
        commands.send('enable\n')
        time.sleep(0.5)
        commands.send('scroll \n')
        time.sleep(0.5)
        commands.send('\n')
        time.sleep(0.5)
        commands.send('display current-configuration' + '\n' + '\n')
        time.sleep(50)
        output = commands.recv(1000000000)  # .recv() - The maximum amount of data to be received at once is specified by nbytes
        output = output.decode("utf-8")  # Change file type from bytes to string
        time.sleep(1.5)
        olt_folder = (ip_address[ip]+"_AR")
        print(ip_address[ip]+" ip reachable..")

        dirName = '//devices-backup//backup-AR-config//' + (olt_folder)
        # Create target directory & all intermediate directories if don't exists
        os.makedirs(dirName, exist_ok=True)
        filename = datetime.datetime.now()
        f = open((dirName) + "//" + filename.strftime("%d %B %Y " + (olt_folder)) + ".txt", "w")
        f.write(output)
        time.sleep(0.5)
        f.close()
    except TimeoutError:
        olt_folder = (ip_address[ip] + "_AR")
        dirName = '//devices-backup//backup-AR-config//Not detected//'
        # Create target directory & all intermediate directories if don't exists
        os.makedirs(dirName, exist_ok=True)
        filename = datetime.datetime.now()
        try:
            f= open((dirName)+"Devices not found.txt","x")
            f = open((dirName) + "Devices not found.txt", "a")
            f.write(olt_folder + " " + (ip) + " not detected -" + filename.strftime("%d %B %Y \n"))
            f.close()
            print(ip_address[ip] + " Not found ")
        except FileExistsError:
            f = open((dirName) + "Devices not found.txt", "a")
            f.write(olt_folder + " " + (ip) + " not detected -" + filename.strftime("%d %B %Y \n"))
            f.close()
            print(ip_address[ip] + " Not found ")